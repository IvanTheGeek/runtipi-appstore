{
    "$schema": "../compose-schema.json",
    "services": [
      {
        "image": "ghcr.io/umami-software/umami:postgresql-v2.10.0",
        "name": "umami",
        "internalPort": 3000,
        "isMain": true,
        "environment": {
          "DATABASE_URL": "postgresql://umami:${DB_PASSWORD}@umami-db:5432/umami",
          "DATABASE_TYPE": "postgresql",
          "HASH_SALT": "${HASH_SALT}"
        },
        "dependsOn": ["umami-db"]
      },
      {
        "image": "postgres:15-alpine",
        "name": "umami-db",
        "environment": {
          "POSTGRES_DB": "umami",
          "POSTGRES_USER": "umami",
          "POSTGRES_PASSWORD": "${DB_PASSWORD}"
        },
        "volumes": [
          {
            "hostPath": "${APP_DATA_DIR}/data/postgres",
            "containerPath": "/var/lib/postgresql/data"
          }
        ]
      }
    ]
  }